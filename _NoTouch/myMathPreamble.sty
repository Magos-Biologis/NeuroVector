\NeedsTeXFormat{LaTeX2e}
\ProvidesPackage{myMathPreamble}[Anakin's personalized Math preamable package]
% ========================= Tools for package ================================

\RequirePackage{ifthen}     % Guess what it does, I dare you
\RequirePackage{etoolbox}   % Includes a lot of useful macros for customizations
\RequirePackage{xkeyval}    % More useful macros
\RequirePackage{xparse}     % More useful macros

%\usepackage{iftex} % Allows for if Lua LaTeX commands

% ========================= Package options

%\DeclareOption*{%
%    \PackageWarning{Math Preamble}{Unknown option ‘\CurrentOption’}%
%}
\ExecuteOptions{}
\ProcessOptions\relax


% ========================= Math Packages

\RequirePackage{mathtools}  % includes amsmath, and increased math utility functions
\RequirePackage[standard, amsmath]{ntheorem}  % Math Theorems

\RequirePackage{cancel}  % Striking through text \cancel{x}
\RequirePackage{MnSymbol}

\RequirePackage{siunitx} % elegant SI units

% ========================= Package Configuration

%\def\start@align#1#2#3{%
%    \let\xatlevel@#1% always \z@, \@ne, or \tw@
%    \maxfields@#3\relax
%    \ifnum\maxfields@>\m@ne
%        \checkat@true
%        \ifnum\xatlevel@=\tw@
%                \xxat@true
%        \fi
%        \multiply\maxfields@\tw@
%    \else
%        \checkat@false
%    \fi
%    \ifingather@
%        \iffalse{\fi\ifnum0=‘}\fi
%        \DN@{\vcenter\bgroup\savealignstate@\align@#2}%
%    \else
%        \ifmmode
%            \if@display
%                \DN@{\align@recover}%
%            \else
%                \nomath@env
%                \DN@{\@namedef{end\@currenvir}{}\@gobble}%
%            \fi
%        \else
%            $$%
%            \let\split\insplit@
%            \DN@{\align@#2}%
%        \fi
%    \fi
%    \collect@body\next@
%}
%\newenvironment{align}{%
%    \start@align\@ne\st@rredfalse\m@ne
%}{%
%    \math@cr \black@\totwidth@
%    \egroup
%    \ifingather@
%        \restorealignstate@
%        \egroup
%        \nonumber
%        \ifnum0=‘{\fi\iffalse}\fi
%    \else
%        $$%
%    \fi
%    \ignorespacesafterend
%}

% Redefine AMS math enviroments definitions + hooks
\renewenvironment{subequations}{%
    \refstepcounter{equation}%
    \protected@edef\theparentequation{\theequation}%
    \setcounter{parentequation}{\value{equation}}%
    \setcounter{equation}{0}%
    \def\theequation{\ensuremath{\theparentequation{}_\mathrm{\,\roman{equation}}}}%
    \ignorespaces%
}{%
    \setcounter{equation}{\value{parentequation}}%
    \ignorespacesafterend
}


% Custom enviroment for making systems of equations built off amsmath align enviroment
%\newenvironment{sysEquation}{%
%    \refstepcounter{equation}%
%    \protected@edef\theparentequation{\theequation}%
%    \setcounter{parentequation}{\value{equation}}%
%    \setcounter{equation}{0}%
%    \def\theequation{\theparentequation-\Alph{equation}}%
%    %
%    \start@align\@ne\st@rredfalse\m@ne
%    %
%    \ignorespaces%
%}{%
%    \math@cr \black@\totwidth@
%    \egroup
%    \ifingather@
%        \restorealignstate@
%        \egroup
%        \nonumber
%        \ifnum0=‘{\fi\iffalse}\fi
%    \else
%        $$%
%    \fi
%    %
%    \setcounter{equation}{\value{parentequation}}%
%    \ignorespacesafterend%
%}

% xparse strat
\ProvideDocumentEnvironment{sysEquation}{ O{\theequation} +b }{%
    \refstepcounter{equation}\label{eq:#1}%
    \protected@edef\theparentequation{\theequation}%
    \setcounter{parentequation}{\value{equation}}%
    \setcounter{equation}{0}%
    \def\theequation{\theparentequation-\Alph{equation}}%
    %
    \start@align\@ne\st@rredfalse\m@ne
    %
    \ignorespaces%
    %
    #2
    }{%
    \math@cr \black@\totwidth@%
    \egroup%
    \ifingather@%
        \restorealignstate@%
        \egroup%
        \nonumber%
        \ifnum0=‘{\fi\iffalse}\fi%
    \else%
        $$%
    \fi%
    %
    \setcounter{equation}{\value{parentequation}}%
    \ignorespacesafterend%
    }


%\def\env@cases{%
%    \let\@ifnextchar\new@ifnextchar
%    \left\lbrace
%    \def\arraystretch{1.2}%
%    \array{@{}l@{\quad}l@{}}%
%}



\addtolength{\jot}{0.75em} % Increases row padding between equations

\abovedisplayskip       = 12pt
\belowdisplayskip       = 12pt
\abovedisplayshortskip  = 0pt
\belowdisplayshortskip  = 7pt

% SI units

\DeclareMathAlphabet\mathbb{U}{msb}{m}{n}
\DeclareMathSizes{10}{18}{12}{8}   % For size 10 text
\DeclareMathSizes{11}{19}{13}{9}   % For size 11 text
\DeclareMathSizes{12}{20}{14}{10}  % For size 12 text

% SI units

\DeclareSIUnit\molar{\mole\per\cubic\deci\metre}
\DeclareSIUnit\Molar{\textsc{m}}
\DeclareSIUnit{\calorie}{cal}
\DeclareSIUnit{\Calorie}{\kilo\calorie}

\robustify\dots
\sisetup{input-digits = 0123456789\dots}%
    
% ========================= Mathy Commands ===============================

\NewDocumentCommand{\br}{ s m }{%
    \IfBooleanTF {#1}{%
        \ensuremath{\left(\,\text{#2}\,\right)}%
        }{%
        \ensuremath{\left(\,#2\,\right)}%
        }%
    } % (.)
\NewDocumentCommand{\sbr}{ s m }{% 
    \IfBooleanTF {#1}{%
        \ensuremath{\left[\,\text{#2}\,\right]}%
        }{%
        \ensuremath{\left[\,#2\,\right]}%
        }%
    } % [.]

\ProvideDocumentCommand{\ode}{ m O{t} }{%
    \frac{\mathrm{d}\displaystyle#1}{\mathrm{d}\displaystyle#2}
    }
\ProvideDocumentCommand{\pde}{ m m }{%
    \frac{\partial\displaystyle#1}{\partial\displaystyle#2}
    }
\NewDocumentCommand{\rfrac}{ m m }{{}^{#1}\!/_{#2}}

%\DeclareMathOperator{\argmax}{arg\,max}

\renewcommand{\exp}[1]{\mathrm{exp}\left(\,#1\,\right)}

\renewcommand{\iff}{\Leftrightarrow}
\renewcommand{\implies}{\Rightarrow}
\renewcommand{\impliedby}{\Leftarrow}

\newcommand{\rmm}[1]{\mathrm{#1}}
\newcommand{\bfm}[1]{\mathbf{#1}}
\newcommand{\itm}[1]{\mathit{#1}}
\newcommand{\clm}[1]{\mathcal{#1}}
\newcommand{\fkm}[1]{\mathfrak{#1}}

\newcommand{\surform}[2]{\ensuremath{\left< #1~:~#2 \right>}}

\providecommand{\N}{\mathbb{N}}
\providecommand{\Z}{\mathbb{Z}}
\providecommand{\Q}{\mathbb{Q}}
\providecommand{\R}{\mathbb{R}}
\providecommand{\C}{\mathbb{C}}
\providecommand{\Su}{N_0}


% ========================= Theorem Enviroments Using Asmath

\theoremstyle{plain}
\theoremheaderfont{\normalfont\bfseries}
\theorembodyfont{\itshape}
\theoremseparator{}
\theorempreskip{\topsep}
\theorempostskip{\topsep}%, where\topseprefers to the spacethat LATEX inserts above and below lists,
\theoremindent0cm
\theoremnumbering{greek}
\theoremsymbol{}



% Custom Fields ======================================================
%\newtheorem{axiom}{Axiom}
%\IfFileExists{Zeambles/MathPreme.sty}{
%    \crefformat{axiom}{Axiom~#2#1#3}
%    \crefrangeformat{axiom}{Axiom~#3#1#4 to~#5#2#6}
%    \crefmultiformat{axiom}{Axiom~#2#1#3}{ and~#2#1#3}{, #2#1#3}{ and~#2#1#3}
%    \crefrangemultiformat{axiom}{Axiom~#2#1#3}{ and~#2#1#3}{, #2#1#3}{, and~#2#1#3}
%}

% ========================================================================
\endinput