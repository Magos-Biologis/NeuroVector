\NeedsTeXFormat{LaTeX2e}
\ProvidesPackage{myMathPreamble}[Anakin's personalized Math preamable package]
% ========================= Tools for package ================================

\RequirePackage{ifthen}     % Guess what it does, I dare you
\RequirePackage{etoolbox}   % Includes a lot of useful macros for customizations
\RequirePackage{xkeyval}    % More useful macros
\RequirePackage{xparse}     % More useful macros

\RequirePackage{iftex}      % Allows for if {type}TeX commands

% ========================= Class tags

% \newif\ifRUCtype@Project@
% \newif\ifRUCtype@Assignment@

\newif\iftagAxiom@

\newif\iftagBase@

% ========================= Package options

\DeclareOption{mathFont}{%
    }

\DeclareOption{unitSI}{%
    }

\DeclareOption{gibAxioms}{%
    \tagAxiom@true
    }


\DeclareOption{clsOverride}{%
    }

\ExecuteOptions{}
\ProcessOptions\relax


% ========================= Math Packages

\RequirePackage{mathtools}  % includes amsmath, and increased math utility functions
\RequirePackage[standard, amsmath]{ntheorem}  % Math Theorems

\ifxetex % Math Fonts
    \RequirePackage[MnSymbol]{mathspec}
    \else
        % \RequirePackage[csmy]{MnSymbol} 
        \RequirePackage[normalweight=auto,boldweight=Bold,largedelims=false]{fdsymbol} 
    \fi


\RequirePackage{cancel}  % Striking through text \cancel{x}
\RequirePackage{siunitx} % elegant SI units

% ========================= Package Configuration

% Custom enviroment for making systems of equations built off amsmath align enviroment
% \def\align@#1#2{%
%     \inalign@true \intertext@ \Let@ \chardef\dspbrk@context\z@
%     \ifingather@\else\displ@y@\fi
%     \let\math@cr@@@\math@cr@@@align
%     \ifxxat@\else \let\tag\tag@in@align \fi
%     \let\label\label@in@display
%     #1% set st@r
%     \ifst@rred\else \global\@eqnswtrue \fi
%     \measure@{#2}%
%     \global\row@\z@
%     \tabskip\eqnshift@
%     \halign\bgroup
%         \span\align@preamble\crcr
%         #2%
%     }
% \def\start@align#1#2#3{%
%    \let\xatlevel@#1% always \z@, \@ne, or \tw@
%    \maxfields@#3\relax
%    \ifnum\maxfields@>\m@ne
%        \checkat@true
%        \ifnum\xatlevel@=\tw@
%                \xxat@true
%        \fi
%        \multiply\maxfields@\tw@
%    \else
%        \checkat@false
%    \fi
%    \ifingather@
%        \iffalse{\fi\ifnum0=‘}\fi
%        \DN@{\vcenter\bgroup\savealignstate@\align@#2}%
%    \else
%        \ifmmode
%            \if@display
%                \DN@{\align@recover}%
%            \else
%                \nomath@env
%                \DN@{\@namedef{end\@currenvir}{}\@gobble}%
%            \fi
%        \else
%            $$%
%            \let\split\insplit@
%            \DN@{\align@#2}%
%        \fi
%    \fi
%    \collect@body\next@
%     }
% \newenvironment{align}{%
%    \start@align\@ne\st@rredfalse\m@ne
%     }{%
%    \math@cr \black@\totwidth@
%    \egroup
%    \ifingather@
%        \restorealignstate@
%        \egroup
%        \nonumber
%        \ifnum0=‘{\fi\iffalse}\fi
%    \else
%        $$%
%    \fi
%    \ignorespacesafterend
%     }
% \newenvironment{align}{%
%     \start@align\@ne\st@rredfalse\m@ne
%     }{%
%     \math@cr \black@\totwidth@
%     \egroup
%     \ifingather@
%     \restorealignstate@
%     \egroup
%     \nonumber
%     \ifnum0=‘{\fi\iffalse}\fi
%     \else
%     $$%
%     \fi
%     \ignorespacesafterend
%     }


% \renewenvironment{cases}{%
%     \matrix@check\cases\env@cases
%     }{%
%     \endarray\right.%
%     }
% \def\env@cases{%
%     \let\@ifnextchar\new@ifnextchar
%     \left\lbrace
%     \def\arraystretch{1.2}%
%     \array{@{}l@{\quad}l@{}}%
%     }




% Redefine AMS math enviroments definitions + hooks
\renewenvironment{subequations}{%
    \refstepcounter{equation}%
    \protected@edef\theparentequation{\theequation}%
    \setcounter{parentequation}{\value{equation}}%
    \setcounter{equation}{0}%
    \def\theequation{\theparentequation\ensuremath{_\mathrm{\,\roman{equation}}\,}}%
    \ignorespaces%
}{%
    \setcounter{equation}{\value{parentequation}}%
    \ignorespacesafterend
}


% xparse strat
\ProvideDocumentEnvironment{sysEquation}{ O{\theequation} +b }{%
    \refstepcounter{equation}\label{eq:#1}%
    \protected@edef\theparentequation{\theequation}%
    \setcounter{parentequation}{\value{equation}}%
    \setcounter{equation}{0}%
    \def\theequation{\theparentequation-\Alph{equation}}%
    %
    %\start@align\z@\st@rredfalse
    \start@align\@ne\st@rredfalse\m@ne
    %
    \ignorespaces%
    %
    #2
    }{%
    \math@cr \black@\totwidth@%
    \egroup%
    \ifingather@%
        \restorealignstate@%
        \egroup%
        \nonumber%
        \ifnum0=‘{\fi\iffalse}\fi%
    \else%
        $$%
    \fi%
    %
    \setcounter{equation}{\value{parentequation}}%
    \ignorespacesafterend%
    }


\ifRUCtype@Project@
    \else
        \DeclareMathSizes{10}{18}{12}{8}   % For size 10 text
        \DeclareMathSizes{11}{19}{13}{9}   % For size 11 text
        \DeclareMathSizes{12}{20}{14}{10}  % For size 12 text
    \fi


\addtolength{\jot}{0.75em} % Increases row padding between equations

\abovedisplayskip       = 12pt
\belowdisplayskip       = 12pt
\abovedisplayshortskip  = 0pt
\belowdisplayshortskip  = 7pt

% SI units

\DeclareSIUnit\molar{\mole\per\cubic\deci\metre}
\DeclareSIUnit\Molar{\textsc{m}}
\DeclareSIUnit{\calorie}{cal}
\DeclareSIUnit{\Calorie}{\kilo\calorie}

\robustify\dots
\sisetup{input-digits = 0123456789\dots}%

\ifRUCtype@Project@
    \sisetup{drop-zero-decimal=true, round-mode=places, round-precision=2}
    \fi
    
% ========================= Mathy Commands ===============================


\NewDocumentCommand{\br}{ s m }{%
    \IfBooleanTF {#1}{%
        \ensuremath{\left(\,\text{#2}\,\right)}%
        }{%
        \ensuremath{\left(\,#2\,\right)}%
        }%
    } % (.)
\NewDocumentCommand{\sbr}{ s m }{% 
    \IfBooleanTF {#1}{%
        \ensuremath{\left[\,\text{#2}\,\right]}%
        }{%
        \ensuremath{\left[\,#2\,\right]}%
        }%
    } % [.]


\ProvideDocumentCommand{\ode}{ s O{t} m O{} }{%
    \IfBooleanTF {#1}{%
        \frac{\mathrm{d}^{#4}}{\mathrm{d}\displaystyle#2^{#4}}\displaystyle#3
        }{%
        \frac{\mathrm{d}^{#4}\displaystyle#3}{\mathrm{d}\displaystyle#2^{#4}}
        }
    }
\ProvideDocumentCommand{\pde}{ s m    m O{} }{%
    \IfBooleanTF {#1}{%
        \frac{\partial^{#4}}{\partial\displaystyle#2^{#4}}\displaystyle#3
        }{%
        \frac{\partial^{#4}\displaystyle#3}{\partial\displaystyle#2^{#4}}
        }
    }

    
\NewDocumentCommand{\rfrac}{ m m }{{}^{{\displaystyle#1}}\!/_{{\displaystyle#2}}}

%\DeclareMathOperator{\argmax}{arg\,max}

\renewcommand{\exp}[1]{\mathrm{exp}\left(\,#1\,\right)}

\renewcommand{\iff}{\Leftrightarrow}
\renewcommand{\implies}{\Rightarrow}
\renewcommand{\impliedby}{\Leftarrow}

\newcommand{\clm}[1]{\mathcal{#1}}
\newcommand{\fkm}[1]{\mathfrak{#1}}
\newcommand{\itm}[1]{\mathit{#1}}
\newcommand{\bfm}[1]{\mathbf{#1}}
\newcommand{\bbm}[1]{\mathbb{#1}}
\newcommand{\rmm}[1]{\mathrm{#1}}

\newcommand{\surform}[2]{\ensuremath{\left< #1~:~#2 \right>}}

\providecommand{\N}{\mathbb{N}}
\providecommand{\Z}{\mathbb{Z}}
\providecommand{\Q}{\mathbb{Q}}
\providecommand{\R}{\mathbb{R}}
\providecommand{\C}{\mathbb{C}}
\providecommand{\Su}{N_0}


% ========================= Theorem Enviroments Using Asmath

\theoremstyle{plain}
\theoremheaderfont{\normalfont\bfseries}
\theorembodyfont{\itshape}
\theoremseparator{}
\theorempreskip{\topsep}
\theorempostskip{\topsep}%, where\topseprefers to the spacethat LATEX inserts above and below lists,
\theoremindent0cm
\theoremnumbering{greek}
\theoremsymbol{}



% Custom Fields ======================================================

%\newtheorem{axiom}{Axiom}
%\IfFileExists{Zeambles/MathPreme.sty}{
%    \crefformat{axiom}{Axiom~#2#1#3}
%    \crefrangeformat{axiom}{Axiom~#3#1#4 to~#5#2#6}
%    \crefmultiformat{axiom}{Axiom~#2#1#3}{ and~#2#1#3}{, #2#1#3}{ and~#2#1#3}
%    \crefrangemultiformat{axiom}{Axiom~#2#1#3}{ and~#2#1#3}{, #2#1#3}{, and~#2#1#3}
%}

% ========================================================================
\endinput