\NeedsTeXFormat{LaTeX2e}
\ProvidesPackage{myReferencePreamble}[Anakin's personalized Refrencing preamable package]
% ========================= Tools for package ================================

\RequirePackage{ifthen}     % Guess what it does, I dare you
\RequirePackage{etoolbox}   % Includes a lot of useful macros for customizations
\RequirePackage{xkeyval}    % Taking in keys for option inputs
\RequirePackage{xparse}     % More useful macros

% ========================= Class tags

% \newif\ifRUCtype@Project@
% \newif\ifRUCtype@Assignment@

\newif\iftagAxiom@

\newif\iftagBibble@
\newif\iftagGlossel@

% ============================ Options =======================================


\DeclareOption{printBibble}{
    \tagBibble@true
    }
    
\DeclareOption{printGloss}{
    \tagGlossel@true
    }


% =============== Pre-defined types

\DeclareOption{printUnit}{
    % Unit Counter
    \newcounter{glsunittype}
    \newglossary*{unit}{Units}[glsunittype]
    \AtEndDocument{
        \printglossary[type = unit]
        }
    }


\DeclareOption{printMath}{
    % Math Counter
    \newcounter{glsmathtype}
    \newglossary*{math}{Math}[glsmathtype]
    \AtEndDocument{
        \printglossary[type = math]
        }
    }

%\DeclareOption*{%
%    \PackageWarning{References}{You're so stupid for thinking that `\CurrentOption' is possible}%
%}

\ExecuteOptions{}
\ProcessOptions\relax

% =========================== Packages =======================================

\RequirePackage[hidelinks]{hyperref}    % For hyperlinks
\PassOptionsToPackage{hyperref}{ntheorem}

\RequirePackage{cleveref}               % For configuration of references

\RequirePackage[%
    backend     = biber,%
    sorting     = none,%
    style       = numeric,%
    ]{biblatex}  % For better function
\RequirePackage[%
    xindy, %
    acronyms,%
    style       = index, %
    ]{glossaries}
%\RequirePackage[%
%    abbreviations,%
%    nonumberlist,%
%    ]{glossaries-extra}
% ====================== Custom References ================================

% Custom hyperref design
\hypersetup{%
    breaklinks=true,            %
    %colorlinks=true,            %
    linkcolor=[rgb]{0.65,0,0},  %
    urlcolor=[rgb]{0,0,0.65},   %
    citecolor=[rgb]{0,0.65,0},  %
    pdfdisplaydoctitle = true,  % Displaying the title instead of the filename
    pdfpagemode=FullScreen,     % Opens the pdf in fullscreen
    }

% Custom cleveref setups
    \crefdefaultlabelformat{#2\ensuremath{\left( \text{\textup{#1}} \right)}#3}
    %\creflabelformat{equation}{#2{\(\left( \textbf{\textup{#1}} \right)\)}#3}
    
    % Generic Fields ======================================================
    \crefformat{figure}%
        {[fig.~\ensuremath{#2\left(\text{\textup{#1}}\right)#3}]}
    \crefrangeformat{figure}%
        {[fig.~\ensuremath{#3\left(\text{\textup{#1}}\right)#4} to~\ensuremath{#5\left(\text{\textup{#2}}\right)#6}}
    \crefmultiformat{figure}%
        {[figs.~\ensuremath{#2\left(\text{\textup{#1}}\right)#3}}%
        { and~\ensuremath{#2\left(\text{\textup{#1}}\right)#3}]}%
        {, \ensuremath{#2\left(\text{\textup{#1}}\right)#3}}%
        { and~\ensuremath{#2\left(\text{\textup{#1}}\right)#3}]}
    \crefrangemultiformat{figure}%
        {[figs.~\ensuremath{#2\left(\text{\textup{#1}}\right)#3}}%
        { and~\ensuremath{#2\left(\text{\textup{#1}}\right)#3}]}%
        {, \ensuremath{#2\left(\text{\textup{#1}}\right)#3}}%
        {, and~\ensuremath{#2\left(\text{\textup{#1}}\right)#3}]}
    
    \Crefformat{figure}%
        {Figure~\ensuremath{#2\left(\text{\textup{#1}}\right)#3}}
    \Crefrangeformat{figure}%
        {Figures~\ensuremath{#3\left(\text{\textup{#1}}\right)#4} through~\ensuremath{#5\left(\text{\textup{#2}}\right)#6}}
    \Crefmultiformat{figure}%
        {Figures~\ensuremath{#2\left(\text{\textup{#1}}\right)#3}}%
        { and~\ensuremath{#2\left(\text{\textup{#1}}\right)#3}}%
        {, \ensuremath{#2\left(\text{\textup{#1}}\right)#3}}%
        { and~\ensuremath{#2\left(\text{\textup{#1}}\right)#3}}
    \Crefrangemultiformat{figure}%
        {Figures~\ensuremath{#2\left(\text{\textup{#1}}\right)#3}}%
        { and~\ensuremath{#2\left(\text{\textup{#1}}\right)#3}}%
        {, \ensuremath{#2\left(\text{\textup{#1}}\right)#3}}%
        {, and~\ensuremath{#2\left(\text{\textup{#1}}\right)#3}}

    
    \crefformat{table}%
        {[tab.~\ensuremath{#2\left(\text{\textup{#1}}\right)#3}]}
    \crefrangeformat{table}%
        {[tab.~\ensuremath{#3\left(\text{\textup{#1}}\right)#4} to~\ensuremath{#5\left(\text{\textup{#2}}\right)#6}]}
    \crefmultiformat{table}%
        {[tabs.~\ensuremath{#2\left(\text{\textup{#1}}\right)#3}}%
        { and~\ensuremath{#2\left(\text{\textup{#1}}\right)#3}]}%
        {, \ensuremath{#2\left(\text{\textup{#1}}\right)#3}}%
        { and~\ensuremath{#2\left(\text{\textup{#1}}\right)#3}]}
    \crefrangemultiformat{table}%
        {[tabs.~\ensuremath{#2\left(\text{\textup{#1}}\right)#3}}%
        { and~\ensuremath{#2\left(\text{\textup{#1}}\right)#3}]}%
        {, \ensuremath{#2\left(\text{\textup{#1}}\right)#3}}%
        {, and~\ensuremath{#2\left(\text{\textup{#1}}\right)#3}]}
    
    \Crefformat{table}%
        {Table~\ensuremath{#2\left(\text{\textup{#1}}\right)#3}}
    \Crefrangeformat{table}%
        {Tables~\ensuremath{#3\left(\text{\textup{#1}}\right)#4} through~\ensuremath{#5\left(\text{\textup{#2}}\right)#6}}
    \Crefmultiformat{table}%
        {Tables~\ensuremath{#2\left(\text{\textup{#1}}\right)#3}}%
        { and~\ensuremath{#2\left(\text{\textup{#1}}\right)#3}}%
        {, \ensuremath{#2\left(\text{\textup{#1}}\right)#3}}%
        { and~\ensuremath{#2\left(\text{\textup{#1}}\right)#3}}
    \Crefrangemultiformat{table}%
        {Tables~\ensuremath{#2\left(\text{\textup{#1}}\right)#3}}%
        { and~\ensuremath{#2\left(\text{\textup{#1}}\right)#3}}%
        {, \ensuremath{#2\left(\text{\textup{#1}}\right)#3}}%
        {, and~\ensuremath{#2\left(\text{\textup{#1}}\right)#3}}


% ====================== Custom Glossary ================================



% Uses xparse to create dual command
\DeclareDocumentCommand{\newDualEntry}{ O{} O{} m m m m }{%
    \newglossaryentry{gls:#3}{%
        name={#5},%
        text={#5\glsadd{#3}},%
        description={#6},%
        #1 %
        }
    \makeglossaries
        \newacronym[%
        see={[See glossary entry;]{gls:#3}}, %
        #2 %
        ]{#3}{#4}{#5\glsadd{gls:#3}
        }
    }

\iftagBibble@
    \AtEndDocument{
        \printbibliography[heading=bibintoc, title={References}]
        }
    \fi

\iftagGlossel@
    \AtEndDocument{
        \microtypesetup{protrusion=false} % disables protrusion locally in the document
        \printglossary
        }
    \fi



%\newDualEntry[<glossaryoptions>][<acronymoptions>]{<key>}{<short>}{<long>}{<description>}

%\newDualEntry{OWD} % label
%  {OWD}            % abbreviation
%  {One-Way Delay}  % long form
%  {The time a packet uses through a network from one host to another} % description

%\AtEndDocument{}

% ========================================================================
\endinput